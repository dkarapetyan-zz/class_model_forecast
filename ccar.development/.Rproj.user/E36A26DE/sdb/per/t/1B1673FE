{
    "contents" : "# Author: David Karapetyan This Function outputs a time series ppnr asset\n# forecast from time series input files for bank position data.\n\n#' \n#' @param position_data  A matrix of a particular bank's present balance sheet\n#' @returnType  \n#' @return object of class MTS\n#' @author David Karapetyan\n#' \n#' \n\nRevenueForecast <- function(position_data) {\n\t.required_colnames_position_data <- c(\"Interest.Bearing.Balances...000.\",\n\t\t\t\"Tot.Fed.Funds...Reverse.Repos...000.\", \"Total.Securities...000.\",\n\t\t\t\"Gross.Loans...Leases...000.\", \"Total.Trading.Assets...000.\",\n\t\t\t\"Total.Assets...000\")\n\t\n\t# create blank revenue forecast time series\n\t.revenue_forecast_ts <- ts(matrix(NA, ncol = 3, nrow = 14), start = c(2014, 3), \n\t\t\tend = c(2017, 4), frequency = 4)\n\t\n\tcolnames(.revenue_forecast_ts) <- c(\"Interest.Earning.Assets\",\n\t\t\t\"Trading.Assets\", \"Total.Assets\")\n\t\n\t.summing_vec <- c(\"Interest.Bearing.Balances...000.\",\n\t\t\t\"Tot.Fed.Funds...Reverse.Repos...000.\", \"Total.Securities...000.\",\n\t\t\t\"Gross.Loans...Leases...000.\", \"Total.Trading.Assets...000.\")\n\t\n\t# first time series entry of our forecast comes from position data\n\t.revenue_forecast_ts[1, \"Interest.Earning.Assets\"] <- sum(position_data[1, .summing_vec])\n\t.revenue_forecast_ts[1, \"Trading.Assets\"] <- position_data[1, \"Total.Trading.Assets...000.\"]\n\t.revenue_forecast_ts[1, \"Total.Assets\"] <- position_data[1, \"Total.Assets...000.\"]\n\t\n\t# remaining entries come from arithmetic on initial time series entry\n\t\n\t.nrow <- nrow(.revenue_forecast_ts)  #for efficient looping\n\tfor (i in 2:.nrow) {\n\t\t.revenue_forecast_ts[i, ] <- .revenue_forecast_ts[1, ] * (1.0125^(i - 1))\n\t}\n\t\n\t\n\treturn(.revenue_forecast_ts)\n}",
    "created" : 1425924623564.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3654523404",
    "id" : "1B1673FE",
    "lastKnownWriteTime" : 1425917320,
    "path" : "C:/ppnr.quant.repo/class_model/src/ppnr_forecast/asset_forecast.R",
    "project_path" : null,
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}